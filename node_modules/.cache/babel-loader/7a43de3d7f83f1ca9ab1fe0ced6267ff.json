{"ast":null,"code":"import { createSlice } from \"@reduxjs/toolkit\";\nconst initialState = {\n  id: null,\n  title: null,\n  amount: null,\n  date: null\n};\nconst ExpencesSlice = createSlice({\n  name: \"Expences\",\n  initialState,\n  reducers: {\n    add(expence) {},\n\n    filter(year) {}\n\n  }\n});\nexport const AddExpence = expence => {\n  // const ctx = useContext(AuthContext);\n  // debugger\n  return async () => {\n    // console.log(ctx.email);\n    const data = await fetch(`https://expencetracker-b3897-default-rtdb.firebaseio.com/users.json?\"email\"&equalTo${localStorage.getItem(\"email\")}`);\n    data.json().then(async data => {\n      let userId = null;\n\n      if (!data) {\n        const userRes = await fetch(\"https://expencetracker-b3897-default-rtdb.firebaseio.com/users.json\", {\n          method: \"post\",\n          body: JSON.stringify({\n            email: localStorage.getItem(\"email\")\n          }),\n          headers: {\n            \"Content-Type\": \"Application/Json\"\n          }\n        });\n\n        if (userRes.ok) {\n          const id = userRes.json().then(user => {\n            return user[\"name\"];\n          });\n          userId = id;\n        }\n      } else {\n        userId = Object.keys(data)[0];\n      }\n\n      fetch(`https://expencetracker-b3897-default-rtdb.firebaseio.com/users/${userId}.json`, {\n        method: \"post\",\n        body: JSON.stringify(expence),\n        headers: {\n          \"Content-Type\": \"Application/Json\"\n        }\n      });\n    });\n    debugger;\n  };\n};\n_c = AddExpence;\nexport default ExpencesSlice;\n\nvar _c;\n\n$RefreshReg$(_c, \"AddExpence\");","map":{"version":3,"sources":["/home/yta-odoo/Documents/pic/recat practice/expence-tracker/src/store/expences-slice.js"],"names":["createSlice","initialState","id","title","amount","date","ExpencesSlice","name","reducers","add","expence","filter","year","AddExpence","data","fetch","localStorage","getItem","json","then","userId","userRes","method","body","JSON","stringify","email","headers","ok","user","Object","keys"],"mappings":"AAAA,SAASA,WAAT,QAA4B,kBAA5B;AAEA,MAAMC,YAAY,GAAG;AACnBC,EAAAA,EAAE,EAAE,IADe;AAEnBC,EAAAA,KAAK,EAAE,IAFY;AAGnBC,EAAAA,MAAM,EAAE,IAHW;AAInBC,EAAAA,IAAI,EAAE;AAJa,CAArB;AAMA,MAAMC,aAAa,GAAGN,WAAW,CAAC;AAChCO,EAAAA,IAAI,EAAE,UAD0B;AAEhCN,EAAAA,YAFgC;AAGhCO,EAAAA,QAAQ,EAAE;AACRC,IAAAA,GAAG,CAACC,OAAD,EAAU,CAAE,CADP;;AAERC,IAAAA,MAAM,CAACC,IAAD,EAAO,CAAE;;AAFP;AAHsB,CAAD,CAAjC;AASA,OAAO,MAAMC,UAAU,GAAIH,OAAD,IAAa;AACrC;AACA;AACA,SAAO,YAAY;AACjB;AACA,UAAMI,IAAI,GAAG,MAAMC,KAAK,CACrB,sFAAqFC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAA8B,EAD9F,CAAxB;AAGAH,IAAAA,IAAI,CAACI,IAAL,GAAYC,IAAZ,CAAiB,MAAOL,IAAP,IAAgB;AAC/B,UAAIM,MAAM,GAAG,IAAb;;AACA,UAAI,CAACN,IAAL,EAAW;AACT,cAAMO,OAAO,GAAG,MAAMN,KAAK,CACzB,qEADyB,EAEzB;AACEO,UAAAA,MAAM,EAAE,MADV;AAEEC,UAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AACnBC,YAAAA,KAAK,EAAEV,YAAY,CAACC,OAAb,CAAqB,OAArB;AADY,WAAf,CAFR;AAKEU,UAAAA,OAAO,EAAE;AACP,4BAAgB;AADT;AALX,SAFyB,CAA3B;;AAYA,YAAGN,OAAO,CAACO,EAAX,EAAc;AACZ,gBAAM1B,EAAE,GAAGmB,OAAO,CAACH,IAAR,GAAeC,IAAf,CAAqBU,IAAD,IAAU;AACvC,mBAAOA,IAAI,CAAC,MAAD,CAAX;AACD,WAFU,CAAX;AAGAT,UAAAA,MAAM,GAAGlB,EAAT;AACD;AAEF,OApBD,MAoBO;AACLkB,QAAAA,MAAM,GAAGU,MAAM,CAACC,IAAP,CAAYjB,IAAZ,EAAkB,CAAlB,CAAT;AACD;;AAEDC,MAAAA,KAAK,CACF,kEAAiEK,MAAO,OADtE,EAEH;AACEE,QAAAA,MAAM,EAAE,MADV;AAEEC,QAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAef,OAAf,CAFR;AAGEiB,QAAAA,OAAO,EAAE;AACP,0BAAgB;AADT;AAHX,OAFG,CAAL;AAUD,KApCD;AAqCA;AACD,GA3CD;AA4CD,CA/CM;KAAMd,U;AAiDb,eAAeP,aAAf","sourcesContent":["import { createSlice } from \"@reduxjs/toolkit\";\n\nconst initialState = {\n  id: null,\n  title: null,\n  amount: null,\n  date: null,\n};\nconst ExpencesSlice = createSlice({\n  name: \"Expences\",\n  initialState,\n  reducers: {\n    add(expence) {},\n    filter(year) {},\n  },\n});\n\nexport const AddExpence = (expence) => {\n  // const ctx = useContext(AuthContext);\n  // debugger\n  return async () => {\n    // console.log(ctx.email);\n    const data = await fetch(\n      `https://expencetracker-b3897-default-rtdb.firebaseio.com/users.json?\"email\"&equalTo${localStorage.getItem(\"email\")}`\n    );\n    data.json().then(async (data) => {\n      let userId = null;\n      if (!data) {\n        const userRes = await fetch(\n          \"https://expencetracker-b3897-default-rtdb.firebaseio.com/users.json\",\n          {\n            method: \"post\",\n            body: JSON.stringify({\n              email: localStorage.getItem(\"email\"),\n            }),\n            headers: {\n              \"Content-Type\": \"Application/Json\",\n            },\n          }\n        );\n        if(userRes.ok){\n          const id = userRes.json().then((user) => {\n            return user[\"name\"];\n          });\n          userId = id;\n        }\n\n      } else {\n        userId = Object.keys(data)[0];\n      }\n\n      fetch(\n        `https://expencetracker-b3897-default-rtdb.firebaseio.com/users/${userId}.json`,\n        {\n          method: \"post\",\n          body: JSON.stringify(expence),\n          headers: {\n            \"Content-Type\": \"Application/Json\",\n          },\n        }\n      );\n    });\n    debugger;\n  };\n};\n\nexport default ExpencesSlice;\n"]},"metadata":{},"sourceType":"module"}